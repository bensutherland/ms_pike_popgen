# Northern pike population genetics study
A repository to accompany the analysis of the northern pike popgen study.     

Citation: #add    

Scripts included here were generated by coauthors: #list     

#### Requirements ####
- samtools     
- bedtools     
- Eric Normandeau's scripts repository

## 00. Data preparation
Download the following and put in `02_input_data`:       
- _Esox lucius_ reference genome [GCA_004634155.1_Eluc_v4_genomic.fna](https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_004634155.1://www.ncbi.nlm.nih.gov/datasets/genome/GCF_004634155.1/)       
- project VCF file from [figshare](#TODO)     
 

## 01. Characterize overall variant counts across chromosomes
Prepare and characterize the chromosomes:     
```
# Change directory
cd 02_input_data

# Trim scaffold names to match formats observed in the VCF e.g., LG03    
sed 's/.*LG/>LG/g' GCA_004634155.1_Eluc_v4_genomic.fna | sed 's/,.*//g' > GCA_004634155.1_Eluc_v4_genomic_renamed.fna    

# Unwrap fasta
fasta_unwrap.py GCA_004634155.1_Eluc_v4_genomic_renamed.fna GCA_004634155.1_Eluc_v4_genomic_renamed_unwrap.fna

# Keep chromosomes only
grep -E -A1 '^>LG' GCA_004634155.1_Eluc_v4_genomic_renamed_unwrap.fna | grep -vE '^--$' - > GCA_004634155.1_Eluc_v4_genomic_renamed_unwrap_chr_only.fna  

# Determine lengths of chromosomes
`fasta_lengths.py GCA_004634155.1_Eluc_v4_genomic_renamed_unwrap_chr_only.fna`    

# Index the reference
samtools faidx ./GCA_004634155.1_Eluc_v4_genomic_renamed_unwrap_chr_only.fna 

```

Determine windows positions per chromosome and extract variants:      
```
# Prepare a windows file      
bedtools makewindows -g ./GCA_004634155.1_Eluc_v4_genomic_renamed_unwrap_chr_only.fna.fai -w 1000000 > windows.bed

# Extract variants per window from each chromosome
bedtools coverage -a windows.bed -b ./Eluc.variants.GATK.iteration.2.b.Full.SNP.GATK_HF_removed.minQ20.mmdp10.mxmdp60.mmc10.mac1.homsumfilt.new.samp.names.recode.vcf -counts > coverage.txt    
```

Use the following script interactively in R to analyze the variants per window and generate plots:      
`01_scripts/plotting_chr_poly_levels.R`    


### Fixed differences across the NACD ###
Use script `01_scripts/fixed_diffs_across_NACD.R` to...    

Other scripts included for the analysis include     

